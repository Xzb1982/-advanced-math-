在计算函数值的过程中，我们经常遇到这样的情况

$$\begin{align*}
f(x)= e^x,求f(3.15)\\
f(3.15)= e^{3.15}
\end{align*}$$
这e^{3.15}确实是个数字，但是我仍然不知道具体是什么，是8呢还是9
如果将e近似于2,3.15近似于3，就没意思了，因为误差有点大

此时我们需要将这样的一个数字转化成精确的十进制数字来表示

那么在六种基本初等函数里面，哪一个最好计算呢？幂函数，还有幂函数的多项式![[Pasted image 20250204102231.png]]

那么我们在拉格朗日中值定理中知道：
$$\begin{align*}
f(b)-f(a)= f'(\xi)(b-a),那么由拉氏定理，若f(x)在a,b为端点构成的区间上满足拉氏定理所需的条件(可以是a>b,也可以b>a)\\
上面的式子，我们进一步写成f(b)= f'(\xi)(b-a)+f(a),之后我们令b=x,a=x_{0},x≠x_{0},同时f'(x)导数要存在\\
那么f(x)= f'(\xi)(x-x_{0})+f(x_{0}),\xi介于x与x_{0}之间，那么这个式子有什么意义呢？\\
此时f(x_{0})是0次多项式，是f(x)的近似值，f'(\xi)(x-x_{0})是f(x)近似于f(x_{0})之后的误差
\end{align*}$$
但关键是，如果f''(x)存在，怎么写成f(x)=多项式相乘的形式呢？
$$\begin{align*}
我们猜想f(x)=f(x_{0})+f'(x_{0})(x-x_{0})+k(x-x_{0})^2\implies k= \frac{f(x)-[f(x_{0})+f'(x_{0})(x-x_{0})]}{(x-x_{0})^2}\\
如果f(x)= a_{0}+a_{1}(x-x_{0}),此时可以得到f'(x)=a_{1},当x=x_{0}时，f(x_{0})=a_{0},那么f'(x_{0})=a_{1}\\
那么当x=x_{0}时，f(x)= f(x_{0})+f'(x_{0})(x-x_{0})，不等于时，f(x)= f(x_{0})+f'(x)(x-x_{0})\\
那么根据上式，如果f''(x)存在，怎么写成f(x)\\
f(x_{0})+f'(x)(x-x_{0})\implies 根据拉氏定理，我想变成这样：f(x)-[f(x_{0})+f'(x)(x-x_{0})]=k(x-x_{0})^2\\
此时，我们想将f(x)写成= f(x_{0})+f'(x_{0})(x-x_{0})+k(x-x_{0})^2
\end{align*}$$
$$\begin{align*}
可是问题在于，为什么不能将当x=x_{0}时，f(x)= f(x_{0})+f'(x_{0})(x-x_{0})直接求二阶导,\\
条件也给了f''(x0)存在， 为什么不能这样做:\\
f'(x)= 0+ f''(x0)(x-x0)+f'(x0)\\=> f'(x)(x-x0)=f''(x0(x-x0)^2+f(x)-f(x0)\\=> f(x)= f'(x)(x-x0)+f(x0)-f''(x0)(x-x0)^2\\
\end{align*}$$
当我们应用拉格朗日中值定理时，我们得到f(x)=f(x0​)+f′(ξ)(x−x0​)其中 ξ 落在 x0​ 与 x 之间。

这实际上是说明在区间内存在一个点，使得函数值与切线（在该点处的斜率乘以 x−x_{0}）的关系成立,而不是对于区间所有的x都可以满足这个关系

同时，若函数非线性（即存在非零的二阶及以上导数），那么它在 x0​ 点的**局部线性近似**，那么f(x0​)+f′(x0​)(x−x0​) 只能在“非常小”的 x−x0 范围内作为一种一阶近似

事实上，函数的线性与非线性和二阶导有关，当二阶导存在且≠0时（因为线性函数也有二阶导数且为0），该函数是非线性的
![[Pasted image 20250204155557.png]]
假设你站在一座缓缓上升的山坡上。你站在某个位置（记作 x0​），此时你观察到脚下的一小段路看起来几乎是直的。实际上，在你站立的那个“局部”区域，山坡的曲率不明显，你可以用一条直线（即切线）来大致描述那一小段路的走向。这条直线就对应于数学上用![[Pasted image 20250204160137.png]]
其中 f′(x0) 是你所在位置的“坡度”（一阶导数）

虽然在你站立的那一小段区域内，这条直线能够很好地描述路的走向，**但如果你沿着山坡走得远一些，你就会发现路开始变得更陡或者变得平缓——这就是“曲率”的作用。** 

==曲率描述了山坡弯曲的程度，而这个信息正是由函数的二阶导数及更高阶导数提供的。==如果一个函数的二阶导数不为零，说明函数的变化不仅仅是“直线式”的，而是存在弯曲（非线性）的趋势。

==因此，用直线来近似函数时，只能捕捉到最初的斜率（即一阶信息），而忽略了弯曲的影响。==只有在 x 非常接近 x0的情况下，这种直线近似才能与实际情况非常接近；而一旦 x 离 x0​ 稍远一点，实际曲线与直线之间的偏差就会越来越明显。如下图：![[03b15711a08b920f119b4b88f397e33.jpg]]

哪怕是带f'(xi)也不行，因为拉氏定理是存在性结论：
$$\begin{align*}
如果这样做呢?\\
f'(x)= 0+ f''(\xi)(x-x0)+f'(\xi)\\
=> 因为 f'(\xi)= \frac{f(x)-f(x0)}{x-x_{0}},\\
那么 (x-x0)f'(x)= f''(\xi)(x-x0)+f(x)-f(x0)\\
f(x)= f(x0)-f''(\xi)(x-x0)+f'(x)(x-x0)
\end{align*}$$
那么，如果对于x≠x0或者是x≠ξ的情况下，就不能这样做了，因为"没那么近似"，我要的是定义域内x全部的二阶导信息。

但是我们为什么能猜想成：[[拉氏定理的应用——用f'(x)表示f(x)]]
$$f(x)=f(x_{0})+f'(x_{0})(x-x_{0})+k(x-x_{0})^2，k= \frac{f(x)-[f(x_{0})+f'(x_{0})(x-x_{0})]}{(x-x_{0})^2}$$
因为带k的是误差值，就是没那么近似的那个部分

那么，我们要怎么求出k呢？

此时要用[[柯西中值定理]]，因为下边是x-x0的平方，不好用拉氏定理

那么：
$$\begin{align*}
令F(x)=f(x)-[f(x_{0})+f'(x_{0})(x-x_{0})];G(x)= (x-x_{0})^2\\
F'(x)= f'(x)-f'(x_{0});F''(x)=f''(x);G'(x)= 2(x-x_{0})*1;G''(x_{0})=2=2!\\
同时，F'(x_{0})=f'(x_{0})-f'(x_{0})=0;F(x_{0})= f(x_{0})-f(x_{0})+f'(x_{0})(x_{0}-x_{0})=0;\\
G'(x_{0})= 0;G(x_{0})= 0
\end{align*}$$
那么（==对于ξ的取值，我们用ξ∈(min{x0​,x},max{x0​,x}).==）：
$$\begin{align*}
k= \frac{F(x)-F(x_{0})}{G(x)-G(x_{0})},∵f(x),g(x)都可导，那么F(x),G(x)也可导，那么根据柯西中值定理k= \frac{F(x)-F(x_{0})}{G(x)-G(x_{0})}= \frac{F'(\xi_{1})}{G'(\xi_{1})},ξ∈(min{x0​,x},max{x0​,x})\\
\frac{F'(\xi_{1})}{G'(\xi_{1})}= \frac{F'(\xi_{1})-F'(x_{0})}{G'(\xi_{1})-G'(x_{0})}=（根据柯西中值定理）\frac{F''(\xi)}{G''(\xi)},x_{0}<\xi<\xi_{1}<x,又∵G''(x)=2!,∴k=\frac{F''(\xi)}{G''(\xi)}= \frac{F''(\xi)}{2!}\\
f(x)=f(x_{0})+f'(x_{0})(x-x_{0})+ \frac{F''(\xi)}{2!} (x-x_{0})^2;
\end{align*}$$
那么，如果f'''(x)存在，则：
$$\begin{align*}
f(x)= f(x_{0})+f'(x_{0})(x-x_{0})+ \frac{f''(x_{0})}{2!}(x-x_{0})^2+ \frac{f'''(\xi)}{3!}(x-x_{0})^3
\end{align*}$$
那么如果f^(n+1) (x)（即f(x)的n+1阶导）存在：
$$f(x)= f(x_{0})+ f'(x_{0})(x-x_{0})+ \frac{f''(x_{0})}{2!}(x-x_{0})^2+···+ \frac{f^{n}(x_{0})}{(n)!}(x-x_{0})^{n}+ \frac{f^{n+1}(\xi)}{(n+1)!}(x-x_{0})^{n+1} $$

那么在以上推导中，我们要解决：
①为什么会想到(x-x0):
因为x-x0方便消去![[Pasted image 20250205102730.png]]
②为什么是(x-x0)^2而不是一次方：
![[Pasted image 20250205103114.png]]
重点在于**（x-x0)^2是更高阶的无穷小量**，其次如果用（x-x0）会与前面的重复，那么此时一阶项 f′(x0)(x−x0)已经捕捉了所有与 (x−x0) 成正比的变化。如果再用 (x−x0) 的形式，那么它会与一阶项重复，无法单独反映二阶导数的作用。二阶信息必须以 (x-x_0)^2 这样更高阶的形式出现，**才能独立刻画误差情况。**


解决完以上的问题，我们总结出这个：

泰勒展开公式（带有拉格朗日余项的）：
$$\begin{align*}
设f^{(n)}(x)在区间I上连续（I的开闭性不做要求，因为和x_{0}与x的开闭有关，而不是整个I区间）\\
在I内部的f^{(n+1)}(x)存在，取x_{0}∈I，\forall x∈I，x≠x_{0}\\
都有f(x)= f(x_{0})+ f'(x_{0})(x-x_{0})+ \frac{f''(x_{0})}{2!}(x-x_{0})^2+···+ \frac{f^{n}(x_{0})}{(n)!}(x-x_{0})^{n}+ \frac{f^{n+1}(\xi)}{(n+1)!}(x-x_{0})^{n+1} \\
同时我们将这个多项式称为f(x)在x_{0}处的n阶泰勒展开公式，同时ξ∈(min{x0​,x},max{x0​,x})（即ξ介于x_{0}和x之间）
\end{align*}$$
因为我们不强调带有ξ的那一项，所以虽然是n+1阶导数，但是是n阶泰勒展开


条件强化版本：
$$\begin{align*}
设f^{(n)}(x)在区间I上连续（I的开闭性不做要求，因为和x_{0}与x的开闭有关，而不是整个I区间）\\
在整个区间I上的f^{(n+1)}(x)存在，取x_{0}∈I，\forall x∈I，x≠x_{0}\\
\end{align*}$$

同时，我们再将：
$$\begin{align*}
f(x)= f(x_{0})+ f'(x_{0})(x-x_{0})+ \frac{f''(x_{0})}{2!}(x-x_{0})^2+···+ \frac{f^{n}(x_{0})}{(n)!}(x-x_{0})^{n}+ \frac{f^{n+1}(\xi)}{(n+1)!}(x-x_{0})^{n+1}\\
f(x_{0})+ f'(x_{0})(x-x_{0})+ \frac{f''(x_{0})}{2!}(x-x_{0})^2+···+ \frac{f^{n}(x_{0})}{(n)!}(x-x_{0})^{n}≜ P_{n}(x),我们将这个称为n次泰勒多项式\\
\frac{f^{n+1}(\xi)}{(n+1)!}(x-x_{0})^{n+1}≜ R_{n}(x),将这个称为拉格朗日余项
\end{align*}$$
那么：
$$\begin{align*}
∵\xi= a+\theta(b-a)，∴不妨令a=x_{0},b=x,x≠x_{0}\\
则\xi = x_{0}+ \theta(x-x_{0}),那么\frac{f^{n+1}(x_{0}+ \theta(x-x_{0}))}{(n+1)!}(x-x_{0})^{n+1}≜ R_{n}(x),将这个称为柯西余项
\end{align*}$$
那么，如果我们将：[[第四个重要极限]]
$$\begin{align*}
f(x) ≈ P_{n}(x),那么误差可以写成|f(x)- P_{n}(x)| = |R_{n}(x)|= |\frac{f^{n+1}(\xi)}{(n+1)!}(x-x_{0})^{n+1}|= \frac{|f^{n+1}(\xi)|}{(n+1)!}|x-x_{0}|^{n+1}\\
那么，这个误差\leq什么呢？我们加一个条件，如果说|f^{(n)}(x)|\leq M(常数)，n=0,1,2···\\
也就是该函数任意一阶导数都小于一个常数M，那么\frac{|f^{n+1}(\xi)|}{(n+1)!}|x-x_{0}|^{n+1}\leq M* \frac{|x-x_{0}|^{n+1}}{(n+1)!}\\
同时根据很久以前学过的第四个重要极限\lim_{ n \to \infty } \frac{a^n}{n!}=0,如果x,x_{0}都给定了，当n\to \infty , M* \frac{|x-x_{0}|^{n+1}}{(n+1)!} \to 0\\
即n越大，将f(x)用这个多项式表示，误差越小
\end{align*}$$
那么继续放缩：
$$\begin{align*}
\frac{|f^{n+1}(\xi)|}{(n+1)!}|x-x_{0}|^{n+1}\leq M* \frac{|x-x_{0}|^{n+1}}{(n+1)!},如果x∈[a,b],那么\\
\frac{|f^{n+1}(\xi)|}{(n+1)!}|x-x_{0}|^{n+1}\leq M* \frac{|x-x_{0}|^{n+1}}{(n+1)!} \leq  M* \frac{|b-a|^{n+1}}{(n+1)!} \\
M* \frac{|b-a|^{n+1}}{(n+1)!} 在n\to \infty 时，这个多项式也趋向于0
\end{align*}$$
这就是函数的逼近理论
![[Pasted image 20250205151353.png]]这一幅图我们可以看到sinx是怎么被逼近的

**误差分析与逼近理论：**

根据泰勒公式的余项表达式（拉格朗日余项），在 x0=0 处，有

![[Pasted image 20250205151520.png]]
如果我们知道所有阶导数都被某个常数 M 所控制，即 ∣f^(n+1) (x)∣≤M（对于正弦函数来说，其所有导数都在区间内有界），那么可以得到![[Pasted image 20250205151558.png]]
![[Pasted image 20250205151612.png]]
可以证明，当多项式的次数 n 越高时，多项式 P_n(x) 和 sin⁡x 的差距（在固定区间内）可以任意小，即多项式序列一致收敛于 sin⁡x。

那么更特别的，可以得出：
$$\begin{align*}
若0∈I，取x_{0}=0,那么f(x)= f(0)+ f'(0)*x+ \frac{f''(0)}{2!}*x^2+···+ \frac{f^{n}(0)}{(n)!}x^{n}+ \frac{f^{n+1}(\xi)}{(n+1)!}x^{n+1}\\
我们称这个公式叫做f(x)在x=0处的n阶麦克劳林公式，R_{n}(x)=\frac{f^{n+1}(\xi)}{(n+1)!}x^{n+1},我们将这一项称作麦克劳林余项
\end{align*}$$


==[[泰勒展开各项的几何解读]]==
$$(x-x_{0})^n$$
当f'(x)存在时，1阶导数的x-x0是一次方，0阶导数的x-x0是0次方，也就是1，0阶导数和1阶导数项都存在;==我们从形式上可以看出是一个一次函数的表达式==，

它代表的是原函数的切线，f(x0)是原函数的目标点的纵坐标，过目标点作切线，斜率是f'(ξ),x0是原函数目标点的x坐标

为什么是从f(x0)开始，因为**f(x0​)** 是曲线在点 x0 的位置，代表曲线的“起点”。

**f′(ξ)(x−x0​)** 是误差项，表示实际函数曲线和从 x0 开始的切线之间的差异。这个误差项依赖于导数 f′(ξ) 和 x - x_0​ 的大小，通常用来量化泰勒展开在某一特定点附近的精度。

在二阶导时，**从几何角度解读二阶导数**：

- f(x_0) 是曲线的起始位置。
- f'(x_0)(x - x_0) 是切线，描述了函数值随 x 的变化的初步线性关系。
- ![[Pasted image 20250206173829.png]]是加速度项，描述了==切线斜率随 x 变化的速度==，帮助我们捕捉曲线的弯曲程度。

那么$$\begin{align*}
k= \frac{f(x)-[f(x_{0})+f'(x_{0})(x-x_{0})]}{(x-x_{0})^2}
\end{align*}$$
我们可以理解成，分子是f(x)-一阶在x=x0处的与原曲线的偏移率，比上分母是x与x0的二阶偏移率
那么k就是我们得到的二阶偏移率值

![[Pasted image 20250206180440.png]]
分子这个部分实际上是描述了==函数 f(x) 与通过 x0 点的切线之间的偏差或差异==。它反映了函数在 x0​ 附近的实际偏离程度。也可以理解为，==原曲线和在 x0​ 处的切线之间的“误差”或“偏移量”。==该项剔除了切线部分，仅仅剩下函数与切线之间的差异，体现了更高阶的变化（比如二次变化）。

![[Pasted image 20250206180546.png]]
这是 x 与 x0​ 之间的二次偏移率，表示 x 和 x0​ 之间的平方差。它作为单位，帮助我们衡量==函数与切线之间的差异的变化率是如何随着 x 和 x0​ 之间的距离变化的。==

通过将函数与切线之间的差异（分子）除以 (x - x_0)^2，我们得到的 k 表示的是这个差异的二阶变化率。换句话说，k 就是原函数的**二阶偏移率**，它实际上是捕捉函数在 x0​ 点附近的曲率或加速度。**如果 k 非常小，表示函数在该点附近表现得接近线性；如果 k 较大，则表示函数在该点附近具有较强的曲率（弯曲）。**

简化对k的推导：
$$\begin{align*}
k= \frac{f(x)-[f(x_{0})+f'(x_{0})(x-x_{0})]}{(x-x_{0})^2}\\
F(x)=f(x)-[f(x_{0})+f'(x_{0})(x-x_{0})];G(x)=(x-x_{0})^2;F(x_{0})=0,G(x_{0})=0\\
F'(x)= f'(x)-f'(x_{0});G'(x)= 2(x-x_{0}); F'(x_{0})=0,G'(x_{0})=0\\
F''(x)= f''(x);G''(x)=2=2!\\
由柯西中值定理得到：\frac{F(x)-F(x_{0})}{G(x)-G(x_{0})}= \frac{F'(\xi_{1})}{G'(\xi_{1})}= \frac{F'(\xi_{1})-F'(x_{0})}{G'(\xi_{1})-G'(x_{0})}=\frac{F''(\xi)}{G''(\xi)}= \frac{F''(\xi)}{2!}
\end{align*}$$
我们可以看到柯西中值定理的使用，是对多项式最后一项使用的，所以最后一项（也就是余项）才有ξ

n阶导= 要比上n的阶乘= x-x0的n平方

